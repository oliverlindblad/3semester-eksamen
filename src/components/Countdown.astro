---
// Props
const { targetDate = "2025-08-04T09:30:00" } = Astro.props;
---

<div 
  x-data="countdownTimer()" 
  x-init={`start("${targetDate}")`}
 
  class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center p-6 text-[#B64014] font-sans"
>
  <!-- Venstre side -->
  <div class="text-left space-y-1">
    <h2 class="text-3xl md:text-4xl font-oswald">Race day 2025</h2>
    <p class="text-xl md:text-2xl font-oswald"> 4. august 9.30</p>
  </div>

  <!-- HÃ¸jre side -->
  <div class="flex justify-start md:justify-end gap-4 text-3xl md:text-6xl font-bold font-mono">
    <div class="flex items-baseline gap-1">
      <span x-text="days">00</span><span class="text-base md:text-6xl font-bebas">D</span>
    </div>
    <div class="flex items-baseline gap-1">
      <span x-text="hours">00</span><span class="text-base md:text-6xl font-bebas">T</span>
    </div>
    <div class="flex items-baseline gap-1">
      <span x-text="minutes">00</span><span class="text-base md:text-6xl font-bebas">M</span>
    </div>
    <div class="flex items-baseline gap-1">
      <span x-text="seconds">00</span><span class="text-base md:text-6xl font-bebas">S</span>
    </div>
  </div>
</div>

<script is:inline>
  function countdownTimer() {
    return {
      days: '00',
      hours: '00',
      minutes: '00',
      seconds: '00',
      interval: null,
      start(targetString) {
        const target = new Date(targetString);
        if (isNaN(target)) {
          console.error('Ugyldig dato:', targetString);
          return;
        }

        const update = () => {
          const now = new Date();
          const diff = target - now;

          if (diff <= 0) {
            this.days = this.hours = this.minutes = this.seconds = '00';
            clearInterval(this.interval);
            return;
          }

          this.days = String(Math.floor(diff / (1000 * 60 * 60 * 24))).padStart(2, '0');
          this.hours = String(Math.floor((diff / (1000 * 60 * 60)) % 24)).padStart(2, '0');
          this.minutes = String(Math.floor((diff / (1000 * 60)) % 60)).padStart(2, '0');
          this.seconds = String(Math.floor((diff / 1000) % 60)).padStart(2, '0');
        };

        update();
        this.interval = setInterval(update, 1000);
      }
    }
  }
</script>
